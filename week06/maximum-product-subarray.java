package Algorithm.leetcode.leetcode.editor.cn;
//ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·ä½ æ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯æœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆè¯¥å­æ•°ç»„ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œå¹¶è¿”å›è¯¥å­æ•°ç»„æ‰€å¯¹åº”çš„ä¹˜ç§¯ã€‚
//
// 
//
// ç¤ºä¾‹ 1: 
//
// è¾“å…¥: [2,3,-2,4]
//è¾“å‡º: 6
//è§£é‡Š:Â å­æ•°ç»„ [2,3] æœ‰æœ€å¤§ä¹˜ç§¯ 6ã€‚
// 
//
// ç¤ºä¾‹ 2: 
//
// è¾“å…¥: [-2,0,-1]
//è¾“å‡º: 0
//è§£é‡Š:Â ç»“æœä¸èƒ½ä¸º 2, å› ä¸º [-2,-1] ä¸æ˜¯å­æ•°ç»„ã€‚ 
// Related Topics æ•°ç»„ åŠ¨æ€è§„åˆ’ 
// ğŸ‘ 849 ğŸ‘ 0


import scala.Int;

//leetcode submit region begin(Prohibit modification and deletion)
class maximum-product-subarray {
    // é¢˜ç›®é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/maximum-product-subarray/
    public int maxProduct(int[] nums) {
        // æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œä¸€å±‚forå¾ªç¯
        // ç©ºé—´å¤æ‚åº¦ï¼šO(N),å¼€äº†ä¸¤ä¸ªdpæ•°ç»„
//        return func1(nums);

        // æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼Œä¸€å±‚forå¾ªç¯
        // ç©ºé—´å¤æ‚åº¦ï¼šO(1),åªæ˜¯ä½¿ç”¨äº†å‡ ä¸ªå˜é‡ï¼Œæ‰€ä»¥æ˜¯O(1)çš„å¤æ‚åº¦ã€‚
        return func2(nums);

    }

    private int func2(int[] nums) {
        // åˆ¤ç©ºï¼Œè¾¹ç•Œæ¡ä»¶
        if (nums.length == 0) {
            return 0;
        }

        // è·å–æ•°ç»„é•¿åº¦
        int length = nums.length;

        // æ–¹æ³•ä¸€ç”¨çš„æ•°ç»„ï¼Œå…¶å®æˆ‘ä»¬æƒ³æƒ³ï¼Œå®Œå…¨å¯ä»¥ä¸ç”¨æ•°ç»„ï¼Œç”¨å˜é‡å³å¯åšè¿™ä»¶äº‹æƒ…äº†
        int preMax = nums[0];
        int preMin = nums[0];
        int curMax = nums[0];
        int curMin = nums[0];
        int res = nums[0];

        // å¾ªç¯dp
        for (int i = 1; i < length; i++) {
            curMax = Math.max(preMax * nums[i], Math.max(nums[i], preMin * nums[i]));
            curMin = Math.min(preMin * nums[i], Math.min(nums[i], preMax * nums[i]));
            res = Math.max(res, curMax);

            // å½“å‰ä¸€æ¬¡å¾ªç¯ç»“æŸåï¼Œå½“å‰çš„æœ€å¤§å€¼ï¼Œå¯¹äºä¸‹ä¸€è½®è€Œè¨€å°±æ˜¯preMaxäº†
            preMax = curMax;
            // å½“å‰ä¸€æ¬¡å¾ªç¯ç»“æŸåï¼Œå½“å‰çš„æœ€å°å€¼ï¼Œå¯¹äºä¸‹ä¸€è½®è€Œè¨€å°±æ˜¯preMinäº†
            preMin = curMin;
        }

        return res;
    }

    /**
     * æ€è·¯ä¸€ï¼šä¸€ç»´DP
     *
     * @param nums åŸå§‹æ•°ç»„
     * @return æœ€å¤§ä¹˜ç§¯
     */
    private int func1(int[] nums) {
        // æ‰¾é‡å¤æ€§ï¼Œå½“å‰çš„æœ€å¤§ä¹˜ç§¯åªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å‰é¢è¿ä¹˜çš„æˆ‘è¦ä¿ç•™å’Œæˆ‘å½“å‰çš„å€¼ä¹˜ä¸€èµ·ï¼Œä¸€ç§æ˜¯æˆ‘ä¸è¦ã€‚è€Œæ˜¯å½“å‰çš„å€¼è‡ªç«‹é—¨æˆ·
        // å®šä¹‰çŠ¶æ€æ•°ç»„ï¼šdp[i]ï¼Œå½“å‰ä½ç½®çš„æœ€å¤§ä¹˜ç§¯å€¼
        // DPæ–¹ç¨‹ï¼šdp[i] = Max{dp[i - 1] * nums[i], nums[i]}
        // ä¸Šé¢çš„æ€è·¯æ˜¯é”™çš„ï¼Œå› ä¸ºå¦‚æœå½“æ•°ç»„ä¸­åªæœ‰å¶æ•°ä¸ªè´Ÿæ•°çš„æ—¶å€™ï¼Œæœ€å¤§å€¼åº”è¯¥æ˜¯æ‰€æœ‰çš„å…ƒç´ ç›¸ä¹˜ã€‚
        // è€ƒè™‘å½“å‰ä½ç½®å¦‚æœæ˜¯ä¸€ä¸ªè´Ÿæ•°çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›ä»¥å®ƒå‰ä¸€ä¸ªä½ç½®ç»“å°¾çš„æŸä¸ªæ®µçš„ç§¯ä¹Ÿæ˜¯ä¸ªè´Ÿæ•°ï¼Œè¿™æ ·å°±å¯ä»¥è´Ÿè´Ÿå¾—æ­£ï¼Œ
        // å¹¶ä¸”æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªç§¯å°½å¯èƒ½ã€Œè´Ÿå¾—æ›´å¤šã€ï¼Œå³å°½å¯èƒ½å°ã€‚å¦‚æœå½“å‰ä½ç½®æ˜¯ä¸€ä¸ªæ­£æ•°çš„è¯ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›ä»¥å®ƒå‰ä¸€ä¸ªä½ç½®ç»“å°¾çš„
        // æŸä¸ªæ®µçš„ç§¯ä¹Ÿæ˜¯ä¸ªæ­£æ•°ï¼Œå¹¶ä¸”å¸Œæœ›å®ƒå°½å¯èƒ½åœ°å¤§ã€‚

        // é‡æ–°å®šä¹‰DPæ–¹ç¨‹ï¼šdpMax = Max{dpMax[i - 1] * nums[i], nums[i], dpMin[i - 1] * nums[i]}
        //  dpMin = Min{dpMax[i - 1] * nums[i], nums[i], dpMin[i - 1] * nums[i]}

        // åˆ¤ç©ºï¼Œè¾¹ç•Œæ¡ä»¶
        if (nums.length == 0) {
            return 0;
        }

        // å¾—åˆ°æ•°ç»„çš„é•¿åº¦
        int length = nums.length;
        // ç”³è¯·dpæ•°ç»„
        int[] dpMax = new int[length];
        int[] dpMin = new int[length];

        // åˆå§‹åŒ–dp[0]
        dpMax[0] = nums[0];
        dpMin[0] = nums[0];
        // å®šä¹‰è®°å½•æœ€å¤§å€¼çš„å˜é‡
        int max = dpMax[0];

        // å¾ªç¯è¿›è¡Œdp
        for (int i = 1; i < length; i++) {
            // è®°å½•æ¯ä¸€æ¬¡çš„æœ€å¤§å€¼æœ€å°å€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æœ€åçš„çœŸæ­£å¾—åˆ°æƒ³è¦çš„æœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯å‰é¢çš„è´Ÿæ•°æ‰æœ‰å¯èƒ½ä¼šè¢«åé¢çš„è´Ÿæ•°çŸ¥é“
            dpMax[i] = Math.max(dpMax[i - 1] * nums[i], Math.max(dpMin[i - 1] * nums[i], nums[i]));
            dpMin[i] = Math.min(dpMin[i - 1] * nums[i], Math.min(dpMax[i - 1] * nums[i], nums[i]));
            // æ¯ä¸€è½®å½“å‰çš„æœ€å¤§å€¼éƒ½ä¸æ•´ä½“æœ€å¤§å€¼æ¯”è¾ƒä¸‹ï¼Œè¿™æ ·éå†å®Œæˆ‘ä»¬é€‰å‡ºçš„å°±æ˜¯æ€»ä½“æœ€å¤§å€¼
            max = Math.max(dpMax[i], Math.max(dpMin[i], max));
        }

        return max;
    }
}
//leetcode submit region end(Prohibit modification and deletion)
